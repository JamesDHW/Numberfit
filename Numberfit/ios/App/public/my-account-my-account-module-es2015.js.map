{"version":3,"sources":["./src/app/my-account/my-account.page.html","./src/app/my-account/my-account-routing.module.ts","./src/app/my-account/my-account.module.ts","./src/app/my-account/my-account.page.scss","./src/app/my-account/my-account.page.ts"],"names":[],"mappings":"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","file":"my-account-my-account-module-es2015.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-menu-button></ion-menu-button>\\n    </ion-buttons>\\n    <ion-title><img class=\\\"header-image\\\" src=\\\"/assets/NumberfitLogo.png\\\"/></ion-title>\\n  </ion-toolbar>\\n  <link rel=\\\"stylesheet\\\" href=\\\"https://cdn.jsdelivr.net/npm/@ionic/core@next/css/ionic.bundle.css\\\"/>\\n</ion-header>\\n\\n<ion-content class=\\\"ion-content\\\">\\n  <ion-card class=\\\"welcome-card\\\">\\n    <ion-card-content>\\n      <ion-card-header>\\n        <ion-card-title class=\\\"welcome-card-title\\\">My Account</ion-card-title>\\n      </ion-card-header>\\n      <ion-item style=\\\"margin-top: 20px;\\\">\\n        <ion-label style=\\\"width: auto !important\\\">Name: </ion-label>\\n        <ion-input value={{user.name}} readonly style=\\\"text-align: left;\\\"></ion-input>\\n      </ion-item>\\n      <ion-item>\\n        <ion-label>Email: </ion-label>\\n        <ion-input value={{user.username}} readonly style=\\\"text-align: left;\\\"></ion-input>\\n      </ion-item>\\n      <ion-item>\\n        <ion-label>School: </ion-label>\\n        <ion-input value={{user.school}} readonly style=\\\"text-align: left;\\\"></ion-input>\\n      </ion-item>\\n      <form [formGroup]=\\\"modifyDetailsFormGroup\\\" id=\\\"modForm\\\">\\n\\n      <ion-item>\\n        <ion-label>Year Group</ion-label>\\n        <ion-select\\n        formControlName=\\\"year\\\" multiple=\\\"false\\\"\\n        cancelText=\\\"Cancel\\\" okText=\\\"Select\\\" placeholder=\\\"{{user.year}}\\\">\\n          <ion-select-option *ngFor=\\\"let year of yearGroups\\\" value={{year}}>\\n            {{year}}\\n          </ion-select-option>\\n        </ion-select>\\n      </ion-item>\\n      <ion-item>\\n        <ion-label>Teacher</ion-label>\\n        <ion-select\\n        formControlName=\\\"teacher\\\" id=\\\"schoolSelect\\\"\\n        multiple=\\\"false\\\" cancelText=\\\"Cancel\\\" okText=\\\"Select\\\" placeholder=\\\"{{teachDef}}\\\">\\n        <ion-select-option *ngFor=\\\"let teacher of teachers;\\\" value={{teacher.username}}>\\n          {{teacher.name}}\\n        </ion-select-option>\\n      </ion-select>\\n      </ion-item>\\n      <ion-item>\\n        <ion-label position=\\\"floating\\\">Change Password</ion-label>\\n        <ion-input formControlName=\\\"password1\\\" type='password'></ion-input>\\n      </ion-item>\\n      <ion-item>\\n        <ion-label position=\\\"floating\\\">Comfirm Password</ion-label>\\n        <ion-input formControlName=\\\"password2\\\" type='password'></ion-input>\\n      </ion-item>\\n      <br>\\n      <ion-button\\n        (click)=\\\"modifyDetails()\\\"\\n        expand='block' fill=\\\"clear\\\">\\n        Confirm Changes\\n      </ion-button>\\n      </form>\\n    </ion-card-content>\\n  </ion-card>\\n</ion-content>\\n\"","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { MyAccountPage } from './my-account.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: MyAccountPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class MyAccountPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { MyAccountPageRoutingModule } from './my-account-routing.module';\n\nimport { MyAccountPage } from './my-account.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ReactiveFormsModule,\n    MyAccountPageRoutingModule\n  ],\n  declarations: [MyAccountPage]\n})\nexport class MyAccountPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL215LWFjY291bnQvbXktYWNjb3VudC5wYWdlLnNjc3MifQ== */\"","import { FormGroup, FormBuilder, Validators } from '@angular/forms';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { ScreenOrientation }      from '@ionic-native/screen-orientation/ngx';\nimport { NativeStorage }          from '@ionic-native/native-storage/ngx';\nimport { Component }              from '@angular/core';\nimport { HTTP }                   from '@ionic-native/http/ngx';\nimport { Md5 }                    from 'ts-md5/dist/md5';\n\n@Component({\n  selector    : 'app-my-account',\n  templateUrl : './my-account.page.html',\n  styleUrls   : ['./my-account.page.scss'],\n})\nexport class MyAccountPage {\n\n  server           : string = require('../config.json').server;\n  cookie           : string;\n  user             : any = {username:\"-\",name:\"-\",school:\"-\",year:\"-\",teacher:\"-\"};\n  yearGroups       : Array<string>;\n  schoolList       : Array<string>;\n  teachers         = [];\n  teachDef         = \"Select.\"\n  modifyDetailsFormGroup: FormGroup;\n\n  constructor(\n    private screenOrientation : ScreenOrientation,\n    private nativeStorage     : NativeStorage,\n    private router            : Router,\n    private http              : HTTP,\n    private route             : ActivatedRoute,\n    formBuilder               : FormBuilder,\n  ) {\n    // lock screen portrait\n    this.screenOrientation.lock(this.screenOrientation.ORIENTATIONS.PORTRAIT);\n    // Get cookie from storage\n    this.nativeStorage.getItem('cookie')\n    .then((data) => {this.cookie = data.cookie});\n    // Get user from storage\n    this.nativeStorage.getItem('user')\n    .then((data) => {\n      this.user = data\n      if(this.user.teacher){;\n        document.getElementById(\"modForm\").style.display = \"none\";\n      }\n\n      this.http.get(this.server+\"/getTeachers?school=\"+this.user.school,{},{})\n      .then(data => {\n        this.teachers = JSON.parse(data.data).teachers\n        this.teachers.forEach(teacher => {\n          if(teacher.username == this.user.mTeacher){\n            this.teachDef = teacher.name\n          }\n        })\n      })\n      .catch(error => {\n        console.log(\"status\", error.status);\n        console.log(\"error\", error.error);\n\n      });\n    });\n\n    this.yearGroups = ['1', '2', '3', '4', '5', '6'];\n    this.modifyDetailsFormGroup = formBuilder.group({\n      password1 : [\"\", [Validators.required]],\n      password2 : [\"\", [Validators.required]],\n      year      : [\"\", [Validators.required]],\n      teacher   : [\"\", [Validators.required]],\n    });\n  }\n\n  modifyDetails(){\n\n    const password1 = this.modifyDetailsFormGroup.value.password1;\n    const password2 = this.modifyDetailsFormGroup.value.password2;\n\n    const credentials = {\n      year     : this.modifyDetailsFormGroup.value.year,\n      mTeacher : this.modifyDetailsFormGroup.value.teacher,\n      cookie   : this.cookie,\n      password : Md5.hashStr(password1),\n    };\n\n    if(!password1){\n      delete credentials[\"password\"]\n    }\n\n    if((password1==password2 && password1.length > 7) || (password1.length==0 && password2.length==0)){\n\n      // console.log(credentials)\n      this.http.setDataSerializer('json');\n      this.http.post(this.server + \"/modifyDetails\", credentials, {'Content-Type': 'application/json'})\n      .then(data => {\n        var year;\n        var mTeacher;\n        if(!this.modifyDetailsFormGroup.value.year){\n          year = this.user.year\n        }else{\n          year = this.modifyDetailsFormGroup.value.year\n        }\n        if(!this.modifyDetailsFormGroup.value.teacher){\n          mTeacher = this.user.mTeacher\n        }else{\n          mTeacher = this.modifyDetailsFormGroup.value.teacher\n        }\n        this.nativeStorage.setItem('user', {\n          username : this.user.username,\n          name     : this.user.name,\n          school   : this.user.school,\n          year     : year,\n          mTeacher : mTeacher,\n          teacher  : this.user.teacher,\n          points   : this.user.points,\n        })\n        .then(() => {\n          // console.log(\"got to play\")\n          this.router.navigate(['/play'])\n          this.presentAlert(\"Success!\",\"\")\n        }, () => this.presentAlert(\"Internal Storage\",\"Error updating details internally.\"));\n      })\n      .catch(error => {\n        console.log(\"error here\",error.error)\n        this.presentAlert(\"Connection\",\"Error updating details to the internet.\");\n      });\n    } else{\n      // error!!!\n      this.presentAlert(\"Password\",\"Please choose a more secure password.\");\n    }\n\n  }\n\n  presentAlert(header, msg) {\n    const alert = document.createElement('ion-alert');\n    alert.header = header;\n    alert.message = msg;\n    alert.buttons = ['OK'];\n    document.body.appendChild(alert);\n    alert.present();\n  }\n\n}\n"],"sourceRoot":"webpack:///"}