{"version":3,"sources":["src/app/sign-in/sign-in.page.html","src/app/sign-in/sign-in-routing.module.ts","src/app/sign-in/sign-in.module.ts","src/app/sign-in/sign-in.page.scss","src/app/sign-in/sign-in.page.ts"],"names":[],"mappings":"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","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-title><img class=\\\"header-image\\\" src=\\\"/assets/NumberfitLogo.png\\\"/></ion-title>\\n    <script type=\\\"module\\\" src=\\\"https://cdn.jsdelivr.net/npm/@ionic/core@next/dist/ionic/ionic.esm.js\\\"></script>\\n    <script nomodule src=\\\"https://cdn.jsdelivr.net/npm/@ionic/core@next/dist/ionic/ionic.js\\\"></script>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content class=\\\"ion-content\\\">\\n  <ion-card class=\\\"welcome-card\\\">\\n    <ion-card-header>\\n      <ion-card-title class=\\\"welcome-card-title\\\">Sign In</ion-card-title>\\n    </ion-card-header>\\n    <ion-card-content class=\\\"welcome-card\\\">\\n      <form [formGroup]=\\\"signInFormGroup\\\">\\n        <ion-item>\\n          <ion-label position=\\\"floating\\\">Username</ion-label>\\n          <ion-input formControlName=\\\"email\\\" type=\\\"email\\\"></ion-input>\\n        </ion-item>\\n        <br>\\n        <ion-item>\\n          <ion-label position=\\\"floating\\\">Password</ion-label>\\n          <ion-input formControlName=\\\"password\\\" type=\\\"password\\\"></ion-input>\\n        </ion-item>\\n        <br>\\n        <ion-button\\n          (click)=\\\"signIn()\\\" [disabled]=\\\"signInFormGroup.invalid\\\"\\n          expand=\\\"block\\\" fill=\\\"clear\\\">\\n          Sign In\\n        </ion-button>\\n      </form>\\n      <ion-button\\n        expand=\\\"block\\\" fill=\\\"clear\\\"\\n        routerLink=\\\"../register\\\" routerDirection=\\\"forward\\\">\\n        Register\\n      </ion-button>\\n    </ion-card-content>\\n  </ion-card>\\n</ion-content>\\n\"","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { SignInPage } from './sign-in.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: SignInPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class SignInPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { SignInPageRoutingModule } from './sign-in-routing.module';\n\nimport { SignInPage } from './sign-in.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    SignInPageRoutingModule\n  ],\n  declarations: [SignInPage]\n})\nexport class SignInPageModule {}\n","export default \".center {\\n  text-align: center;\\n  margin-top: 40px;\\n}\\n\\n.button1 {\\n  width: 100px;\\n  margin-top: 40px;\\n  color: \\\"secondary\\\";\\n  size: \\\"medium\\\";\\n}\\n\\n.button2 {\\n  width: 100px;\\n  margin-top: 15px;\\n  color: \\\"secondary\\\";\\n  size: \\\"medium\\\";\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYW1lcy9naXRodWIvTnVtYmVyZml0L051bWJlcmZpdC9zcmMvYXBwL3NpZ24taW4vc2lnbi1pbi5wYWdlLnNjc3MiLCJzcmMvYXBwL3NpZ24taW4vc2lnbi1pbi5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0U7RUFDRSxrQkFBQTtFQUNBLGdCQUFBO0FDQUo7O0FER0U7RUFDRSxZQUFBO0VBQ0EsZ0JBQUE7RUFDQSxrQkFBQTtFQUNBLGNBQUE7QUNBSjs7QURHRTtFQUNFLFlBQUE7RUFDQSxnQkFBQTtFQUNBLGtCQUFBO0VBQ0EsY0FBQTtBQ0FKIiwiZmlsZSI6InNyYy9hcHAvc2lnbi1pbi9zaWduLWluLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIlxuICAuY2VudGVyIHtcbiAgICB0ZXh0LWFsaWduOmNlbnRlcjsgXG4gICAgbWFyZ2luLXRvcDogNDBweDtcbiAgfVxuXG4gIC5idXR0b24xIHtcbiAgICB3aWR0aDogMTAwcHg7IFxuICAgIG1hcmdpbi10b3A6IDQwcHg7XG4gICAgY29sb3I6IFwic2Vjb25kYXJ5XCI7XG4gICAgc2l6ZTogXCJtZWRpdW1cIjsgXG4gIH1cblxuICAuYnV0dG9uMiB7XG4gICAgd2lkdGg6IDEwMHB4OyBcbiAgICBtYXJnaW4tdG9wOiAxNXB4O1xuICAgIGNvbG9yOiBcInNlY29uZGFyeVwiO1xuICAgIHNpemU6IFwibWVkaXVtXCI7IFxuICB9IiwiLmNlbnRlciB7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgbWFyZ2luLXRvcDogNDBweDtcbn1cblxuLmJ1dHRvbjEge1xuICB3aWR0aDogMTAwcHg7XG4gIG1hcmdpbi10b3A6IDQwcHg7XG4gIGNvbG9yOiBcInNlY29uZGFyeVwiO1xuICBzaXplOiBcIm1lZGl1bVwiO1xufVxuXG4uYnV0dG9uMiB7XG4gIHdpZHRoOiAxMDBweDtcbiAgbWFyZ2luLXRvcDogMTVweDtcbiAgY29sb3I6IFwic2Vjb25kYXJ5XCI7XG4gIHNpemU6IFwibWVkaXVtXCI7XG59Il19 */\"","import { FormGroup, FormBuilder, Validators } from '@angular/forms';\nimport { ScreenOrientation } from '@ionic-native/screen-orientation/ngx';\nimport { NativeStorage }     from '@ionic-native/native-storage/ngx';\nimport { Component }         from '@angular/core';\nimport { Router }            from '@angular/router';\nimport { HTTP }              from '@ionic-native/http/ngx';\nimport { Md5 }               from 'ts-md5/dist/md5';\n\n\n\n@Component({\n  selector    : 'app-sign-in',\n  templateUrl : './sign-in.page.html',\n  styleUrls   : ['./sign-in.page.scss'],\n})\n\nexport class SignInPage {\n\n  signInFormGroup : FormGroup;\n  server          : string = require('../config.json').server;\n  // server          : string = \"http://localhost:3000\";\n  cookie          : any;\n\n  constructor(\n    private screenOrientation : ScreenOrientation,\n    private nativeStorage     : NativeStorage,\n    private router            : Router,\n    private http              : HTTP,\n    formBuilder               : FormBuilder,\n  ) {\n    // lock screen portrait\n    this.screenOrientation.lock(this.screenOrientation.ORIENTATIONS.PORTRAIT);\n    // Get cookie from storage\n    this.cookie = this.nativeStorage.getItem('cookie');\n\n    // Initialise sign in form group\n    this.signInFormGroup = formBuilder.group({\n      email    : [\"\", [Validators.required]],\n      password : [\"\", [Validators.required]],\n    });\n\n  }\n\n  signIn(){\n    // Get credentials from form\n    const credentials = {\n      'username' : this.signInFormGroup.value.email.toLowerCase(),\n      'password' : Md5.hashStr(this.signInFormGroup.value.password)\n    }\n    console.log(\"credentials\", credentials)\n    console.log(\"password\", this.signInFormGroup.value.password)\n\n    this.http.setDataSerializer('json');\n    this.http.post(this.server + \"/login\",credentials, {'Content-Type': 'application/json'})\n    .then(data => {\n      var user = JSON.parse(data.data);\n      // console.log(\"user: \", user)\n      this.nativeStorage.setItem('cookie', {cookie: user.cookie})\n      .then(() => {\n        var savedUser = {\n          username : user.username,\n          name     : user.name,\n          school   : user.school,\n          teacher  : user.teacher,\n        }\n        if(!user.teacher){\n          savedUser[\"year\"]     = user.year\n          savedUser[\"points\"]   = user.points\n          savedUser[\"mTeacher\"] = user.mTeacher\n        }\n        //save info\n        this.nativeStorage.setItem('user', savedUser)\n        .then(() => {\n          // console.log(\"got to play\")\n          this.router.navigate(['/play'])\n        }, error => console.error('Error storing user', error));\n      }, error => console.error('Error storing cookie', error));\n\n    })\n    .catch(error => {\n      console.log(\"error here\", error.error)\n      if(error.error[\"errors\"] == \"No user found\"){\n        this.presentAlert(\"Credentials\",\"Invalid credentials.\")\n      } else{\n        this.presentAlert(\"Connection\",\"Error logging in to Numberfit.\");\n      }\n    });\n\n  }\n\n  presentAlert(header, msg) {\n    const alert = document.createElement('ion-alert');\n    alert.header = header;\n    alert.message = msg;\n    alert.buttons = ['OK'];\n    document.body.appendChild(alert);\n    alert.present();\n  }\n}\n"],"sourceRoot":"webpack:///","file":"sign-in-sign-in-module-es5.js"}