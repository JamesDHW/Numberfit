{"version":3,"sources":["src/app/my-account/my-account.page.html","src/app/my-account/my-account-routing.module.ts","src/app/my-account/my-account.module.ts","src/app/my-account/my-account.page.scss","src/app/my-account/my-account.page.ts"],"names":[],"mappings":"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","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-menu-button></ion-menu-button>\\n    </ion-buttons>\\n    <ion-title><img class=\\\"header-image\\\" src=\\\"/assets/NumberfitLogo.png\\\"/></ion-title>\\n  </ion-toolbar>\\n  <link rel=\\\"stylesheet\\\" href=\\\"https://cdn.jsdelivr.net/npm/@ionic/core@next/css/ionic.bundle.css\\\"/>\\n</ion-header>\\n\\n<ion-content class=\\\"ion-content\\\">\\n  <ion-card class=\\\"welcome-card\\\">\\n    <ion-card-content>\\n      <ion-card-header>\\n        <ion-card-title class=\\\"welcome-card-title\\\">My Account</ion-card-title>\\n      </ion-card-header>\\n      <ion-item style=\\\"margin-top: 20px;\\\">\\n        <ion-label style=\\\"width: auto !important\\\">Name: </ion-label>\\n        <ion-input value={{user.name}} readonly style=\\\"text-align: left;\\\"></ion-input>\\n      </ion-item>\\n      <ion-item>\\n        <ion-label>Email: </ion-label>\\n        <ion-input value={{user.username}} readonly style=\\\"text-align: left;\\\"></ion-input>\\n      </ion-item>\\n      <ion-item>\\n        <ion-label>School: </ion-label>\\n        <ion-input value={{user.school}} readonly style=\\\"text-align: left;\\\"></ion-input>\\n      </ion-item>\\n      <form [formGroup]=\\\"modifyDetailsFormGroup\\\" id=\\\"modForm\\\">\\n\\n      <ion-item>\\n        <ion-label>Year Group</ion-label>\\n        <ion-select\\n        formControlName=\\\"year\\\" multiple=\\\"false\\\"\\n        cancelText=\\\"Cancel\\\" okText=\\\"Select\\\" placeholder=\\\"{{user.year}}\\\">\\n          <ion-select-option *ngFor=\\\"let year of yearGroups\\\" value={{year}}>\\n            {{year}}\\n          </ion-select-option>\\n        </ion-select>\\n      </ion-item>\\n      <ion-item>\\n        <ion-label>Teacher</ion-label>\\n        <ion-select\\n        formControlName=\\\"teacher\\\" id=\\\"schoolSelect\\\"\\n        multiple=\\\"false\\\" cancelText=\\\"Cancel\\\" okText=\\\"Select\\\" placeholder=\\\"{{teachDef}}\\\">\\n        <ion-select-option *ngFor=\\\"let teacher of teachers;\\\" value={{teacher.username}}>\\n          {{teacher.name}}\\n        </ion-select-option>\\n      </ion-select>\\n      </ion-item>\\n      <ion-item>\\n        <ion-label position=\\\"floating\\\">Change Password</ion-label>\\n        <ion-input formControlName=\\\"password1\\\" type='password'></ion-input>\\n      </ion-item>\\n      <ion-item>\\n        <ion-label position=\\\"floating\\\">Comfirm Password</ion-label>\\n        <ion-input formControlName=\\\"password2\\\" type='password'></ion-input>\\n      </ion-item>\\n      <br>\\n      <ion-button\\n        (click)=\\\"modifyDetails()\\\"\\n        expand='block' fill=\\\"clear\\\">\\n        Confirm Changes\\n      </ion-button>\\n      </form>\\n    </ion-card-content>\\n  </ion-card>\\n</ion-content>\\n\"","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { MyAccountPage } from './my-account.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: MyAccountPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class MyAccountPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { MyAccountPageRoutingModule } from './my-account-routing.module';\n\nimport { MyAccountPage } from './my-account.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ReactiveFormsModule,\n    MyAccountPageRoutingModule\n  ],\n  declarations: [MyAccountPage]\n})\nexport class MyAccountPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL215LWFjY291bnQvbXktYWNjb3VudC5wYWdlLnNjc3MifQ== */\"","import { FormGroup, FormBuilder, Validators } from '@angular/forms';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { ScreenOrientation }      from '@ionic-native/screen-orientation/ngx';\nimport { NativeStorage }          from '@ionic-native/native-storage/ngx';\nimport { Component }              from '@angular/core';\nimport { HTTP }                   from '@ionic-native/http/ngx';\nimport { Md5 }                    from 'ts-md5/dist/md5';\n\n@Component({\n  selector    : 'app-my-account',\n  templateUrl : './my-account.page.html',\n  styleUrls   : ['./my-account.page.scss'],\n})\nexport class MyAccountPage {\n\n  server           : string = require('../config.json').server;\n  cookie           : string;\n  user             : any = {username:\"-\",name:\"-\",school:\"-\",year:\"-\",teacher:\"-\"};\n  yearGroups       : Array<string>;\n  schoolList       : Array<string>;\n  teachers         = [];\n  teachDef         = \"Select.\"\n  modifyDetailsFormGroup: FormGroup;\n\n  constructor(\n    private screenOrientation : ScreenOrientation,\n    private nativeStorage     : NativeStorage,\n    private router            : Router,\n    private http              : HTTP,\n    private route             : ActivatedRoute,\n    formBuilder               : FormBuilder,\n  ) {\n    // lock screen portrait\n    this.screenOrientation.lock(this.screenOrientation.ORIENTATIONS.PORTRAIT);\n    // Get cookie from storage\n    this.nativeStorage.getItem('cookie')\n    .then((data) => {this.cookie = data.cookie});\n    // Get user from storage\n    this.nativeStorage.getItem('user')\n    .then((data) => {\n      this.user = data\n      if(this.user.teacher){;\n        document.getElementById(\"modForm\").style.display = \"none\";\n      }\n\n      this.http.get(this.server+\"/getTeachers?school=\"+this.user.school,{},{})\n      .then(data => {\n        this.teachers = JSON.parse(data.data).teachers\n        this.teachers.forEach(teacher => {\n          if(teacher.username == this.user.mTeacher){\n            this.teachDef = teacher.name\n          }\n        })\n      })\n      .catch(error => {\n        console.log(\"status\", error.status);\n        console.log(\"error\", error.error);\n\n      });\n    });\n\n    this.yearGroups = ['1', '2', '3', '4', '5', '6'];\n    this.modifyDetailsFormGroup = formBuilder.group({\n      password1 : [\"\", [Validators.required]],\n      password2 : [\"\", [Validators.required]],\n      year      : [\"\", [Validators.required]],\n      teacher   : [\"\", [Validators.required]],\n    });\n  }\n\n  modifyDetails(){\n\n    const password1 = this.modifyDetailsFormGroup.value.password1;\n    const password2 = this.modifyDetailsFormGroup.value.password2;\n\n    const credentials = {\n      year     : this.modifyDetailsFormGroup.value.year,\n      mTeacher : this.modifyDetailsFormGroup.value.teacher,\n      cookie   : this.cookie,\n      password : Md5.hashStr(password1),\n    };\n\n    if(!password1){\n      delete credentials[\"password\"]\n    }\n\n    if((password1==password2 && password1.length > 7) || (password1.length==0 && password2.length==0)){\n\n      // console.log(credentials)\n      this.http.setDataSerializer('json');\n      this.http.post(this.server + \"/modifyDetails\", credentials, {'Content-Type': 'application/json'})\n      .then(data => {\n        var year;\n        var mTeacher;\n        if(!this.modifyDetailsFormGroup.value.year){\n          year = this.user.year\n        }else{\n          year = this.modifyDetailsFormGroup.value.year\n        }\n        if(!this.modifyDetailsFormGroup.value.teacher){\n          mTeacher = this.user.mTeacher\n        }else{\n          mTeacher = this.modifyDetailsFormGroup.value.teacher\n        }\n        this.nativeStorage.setItem('user', {\n          username : this.user.username,\n          name     : this.user.name,\n          school   : this.user.school,\n          year     : year,\n          mTeacher : mTeacher,\n          teacher  : this.user.teacher,\n          points   : this.user.points,\n        })\n        .then(() => {\n          // console.log(\"got to play\")\n          this.router.navigate(['/play'])\n          this.presentAlert(\"Success!\",\"\")\n        }, () => this.presentAlert(\"Internal Storage\",\"Error updating details internally.\"));\n      })\n      .catch(error => {\n        console.log(\"error here\",error.error)\n        this.presentAlert(\"Connection\",\"Error updating details to the internet.\");\n      });\n    } else{\n      // error!!!\n      this.presentAlert(\"Password\",\"Please choose a more secure password.\");\n    }\n\n  }\n\n  presentAlert(header, msg) {\n    const alert = document.createElement('ion-alert');\n    alert.header = header;\n    alert.message = msg;\n    alert.buttons = ['OK'];\n    document.body.appendChild(alert);\n    alert.present();\n  }\n\n}\n"],"sourceRoot":"webpack:///","file":"my-account-my-account-module-es5.js"}